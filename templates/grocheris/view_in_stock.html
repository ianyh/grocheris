{% extends 'grocheris/base.html' %}

{% block script %}
<script type="text/javascript">
function lowOn(id) {
    var url = '/item/' + id + '/low/';
    $.post(url,
	   function (data) {
	       $('#item-' + data['id'] + '-low-button').attr('disabled', 'disabled');
	       $('#item-' + data['id']).addClass('low');
	   });
}

function outOf(id) {
    var url = '/item/' + id + '/out/';
    $.post(url,
	   removeItemRow);
}

function removeItemRow(data) {
    if (data) {
	console.log('item was outed');
	$('#item-' + data['id']).fadeOut('fast');
    }
}
</script>
{% endblock %}

{% block title %}Stuff we have{% endblock %}

{% block content %}

{% if items %}
<table>
  {% for item in items %}
  <tr><td id="item-{{ item.id }}">{{ item }}
      {% if item.is_low %}
      <input id="item-{{ item.id }}-low-button" type="button" value="we're low" onClick="lowOn({{ item.id }})" disabled="disabled" />
      {% else %}
      <input id="item-{{ item.id }}-low-button" type="button" value="we're low" onClick="lowOn({{ item.id }})" />
      {% endif %}

      {% if item.is_out %}
      <input id="item-{{ item.id }}-out-button" type="button" value="we're out" onClick="outOf({{ item.id }})" disabled="disabled" />
      {% else %}
      <input id="item-{{ item.id }}-out-button" type="button" value="we're out" onClick="outOf({{ item.id }})" />
      {% endif %}
  </td></tr>
  {% endfor %}
</table>
{% endif %}
  
{% endblock %}
