{% load grocheris_extras %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
  <head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript">
function toggleSelection(checkbox) {
    if (checkbox.checked) {
	$(':checkbox').attr('checked', 'checked');
    } else {
	$(':checkbox').removeAttr('checked');
    }
}

function removeItemRow(data) {
    $('#item-' + data['id']).fadeOut('fast');
}

function afterLow(data) {
    $('#item-' + data['id'] + '-low-button').attr('disabled', 'disabled');
    $('#item-' + data['id']).addClass('low');
}

function afterOut(data) {
    $('#item-' + data['id'] + '-low-button').attr('disabled', 'disabled');
    $('#item-' + data['id'] + '-out-button').attr('disabled', 'disabled');
    $('#item-' + data['id']).addClass('out');
}

function afterBuy(data) {
    $('#item-' + data['id'] + '-low-button').removeAttr('disabled');
    $('#item-' + data['id'] + '-out-button').removeAttr('disabled');
    $('#item-' + data['id']).removeClass('low out');
}

function buyItem(id) {
    url = '{% url buy item_id=0 %}'.replace('0', id);
    $.post(url,
	   afterBuy);
}

function lowOn(id) {
    var url = '{% url low item_id=0 %}'.replace('0', id);
    $.post(url,
	   afterLow);
}

function outOf(id) {
    var url = '{% url out item_id=0 %}'.replace('0', id);
    $.post(url,
	   afterOut);
}

function deleteSelectedItems() {
    $.each($('input:checked'), function(index, value) {
	var id = value.id;
	if (id == '') return;
	var url = '{% url delete item_id=0 %}'.replace('0', id);
	$.post(url,
	       function (data) {
		   if (data) {
		       $('#item-' + data['id']).fadeOut('fast');
		   }
	       });
    });
}

function lowSelectedItems() {
    $.each($('input:checked'), function(index, value) {
	var id = value.id;
	var url = '{% url low item_id=0 %}'.replace('0', id);
	$.post(url,
	       afterLow);
    });
}

function outSelectedItems() {
    $.each($('input:checked'), function(index, value) {
	var id = value.id;
	var url = '{% url out item_id=0 %}'.replace('0', id);
	$.post(url,
	       afterOut);
    });
}

function buySelectedItems() {
    $.each($('input:checked'), function(index, value) {
	var id = value.id;
	var url = '{% url buy item_id=0 %}'.replace('0', id);
	$.post(url,
	       afterBuy);
    });
}

    </script>

    {% block script %}{% endblock %}
    
    <title>{% block title %}{% endblock %}</title>    

    <style type="text/css">
      html, body {
	  font: normal 14px/20px Helvetica, Verdana;
	  margin: 0;
	  padding: 0;
      }

      div {
	  display: block;
      }

      a:link, a:visted {
	  color: #000;
      }

      a:hover {
	  color: #999;
      }

      #content {
	  width: 60%;
	  margin-left: 50px;
      }

      #nav {
	  float: right;
	  width: 30%;
      }

      #item-table {
	  width: 70%;
	  margin: 10px 10px 10px 10px;
      }

      .item-row {
	  border-bottom: 1px black dotted;
      }

      .item-row-nav {
	  float: right;
	  visibility: hidden;
      }

      .item-row-name {
      }

      .delete {
	  float: left;
	  padding-left: 2px;
	  padding-right: 15px;
	  font-size: 0.7em;
	  visibility: hidden;
      }

      .low {
	  background: #ffffe0;
      }

      .out {
	  background: #f08080;
      }
    </style>
  </head>

  <body>

    <div id="nav">
      <a href="{% url index %}">All the stuff</a> <br />
      <a href="{% url stock %}">Stuff we have</a> <br />
      <a href="{% url shop %}">Shopping list</a>
    </div>

    <div id="content">
      {% block content %}

      {% endblock %}
    </div>

  </body>
</html>
